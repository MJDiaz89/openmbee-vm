<h1><code ng:non-bindable="">ElementService</code>
<div><span class="hint">service in module <code ng:non-bindable="">mms</code>
</span>
</div>
</h1>
<div><h2 id="description">Description</h2>
<div class="description"><div class="mms-elementservice-page"><p>An element CRUD service with additional convenience methods for managing edits.</p>
</div></div>
<h2 id="dependencies">Dependencies</h2>
<ul class="dependencies"><li><code ng:non-bindable=""><a href="#/api/ng.$q">$q</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/ng.$http">$http</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/mms.URLService">URLService</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/mms.UtilsService">UtilsService</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/mms.CacheService">CacheService</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/mms.HttpService">HttpService</a></code>
</li>
</ul>
<div class="member method"><h2 id="methods">Methods</h2>
<ul class="methods"><li><h3 id="methods_cacheelement">cacheElement(reqOb, elementOb, edit)</h3>
<div class="cacheelement"><div class="mms-elementservice-cacheelement-page"><p>handles caching of element objects - in case the metadata of reqOb is different
from the element&#39;s canonical projectId/refId/commitId (due to being requested 
from a different project context), it&#39;ll become an alias</p>
</div><h5 id="methods_cacheelement_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-cacheelement-page"><p>request keys - {projectId, refId, elementId, commitId, extended}</p>
</div></td></tr><tr><td>elementOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-cacheelement-page"><p>object to cache</p>
</div></td></tr><tr><td>edit</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-cacheelement-page"><p>whether object to cache is for editing</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_cacheelement_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-cacheelement-page"><p>cached object</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_createelement">createElement(reqOb)</h3>
<div class="createelement"><div class="mms-elementservice-createelement-page"><p>Create element on mms.</p>
</div><h5 id="methods_createelement_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-createelement-page"><p>see description of getElement, instead of elementId, &#39;element&#39; key should be
the element object to create</p>
</div></td></tr></tbody></table><h5 id="methods_createelement_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-createelement-page"><p>The promise will be resolved with the created element references if
create is successful.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_createelements">createElements(reqOb)</h3>
<div class="createelements"><div class="mms-elementservice-createelements-page"><p>Create elements to alfresco and update the cache if successful.</p>
</div><h5 id="methods_createelements_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-createelements-page"><p>see description of getElement, instead of elementId, &#39;elements&#39; key should be
the array of element object to create</p>
</div></td></tr></tbody></table><h5 id="methods_createelements_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-createelements-page"><p>The promise will be resolved with an array of created element references if
create is successful.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getelement">getElement(reqOb, weight, update)</h3>
<div class="getelement"><div class="mms-elementservice-getelement-page"><p>Gets an element object by projectId and elementId. If the element object is already in the cache,
resolve the existing reference, if not or update is true, request it from server, 
add/merge into the cache. </p>
<p>Most of these methods return promises that will reject with a reason object
when a server call fails, see
<a href="#/api/mms.URLService#methods_handlehttpstatus">the return object</a></p>
<h5 id="methods_getelement_example-usage">Example Usage</h5>
<p> <pre class="prettyprint linenums">
        ElementService.getElement({projectId: 'projectId', elementId: 'element_id'}).then(
            function(element) { //element is an element object (see json schema)
                alert('got ' + element.name);
            }, 
            function(reason) {
                alert('get element failed: ' + reason.message); 
                //see mms.URLService#handleHttpStatus for the reason object
            }
        );
        </pre>
<h5 id="methods_getelement_example-with-commitid">Example with commitId</h5>
<p> <pre class="prettyprint linenums">
        ElementService.getElement({
            projectId: 'projectId', 
            elementId: 'elementId', 
            refId: 'refId',         //default 'master'
            commitId: 'commitId',   //default 'latest'
            extended: true          //default false (extended includes _qualifiedName, _qualifiedId, _childViews)
        }).then(
            function(element) { //element is an element object (see json schema)
                alert('got ' + element.name);
            }, 
            function(reason) {
                alert('get element failed: ' + reason.message); 
                //see mms.URLService#handleHttpStatus for the reason object
            }
        );
        </pre>
</div><h5 id="methods_getelement_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-getelement-page"><p>object with keys as described in function description.</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-getelement-page"><p>priority of request (2 is immediate, 1 is normal, 0 is low)</p>
</div> <p><em>(default: 1)</em></p></td></tr><tr><td>update</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-getelement-page"><p>(optional) whether to always get the latest
from server, even if it&#39;s already in cache (this will update the cache if exists)</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_getelement_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-getelement-page"><p>The promise will be resolved with the element object,
multiple calls to this method with the same parameters would give the
same object</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getelementforedit">getElementForEdit(reqOb, weight, update)</h3>
<div class="getelementforedit"><div class="mms-elementservice-getelementforedit-page"><p>Gets an element object to edit by id. (this is different from getElement in 
that the element is a clone and not the same reference. The rationale is to
consider angular data bindings so editing an element does not cause unintentional
updates to other parts of the view, separating reads and edits)</p>
<h5 id="methods_getelementforedit_example">Example</h5>
<p> <pre class="prettyprint linenums">
        ElementService.getElementForEdit(reqOb).then(
            function(editableElement) {
                editableElement.name = 'changed name'; //immediately change a name and save
                ElementService.updateElement(editableElement).then(
                    function(updatedElement) { //at this point the regular getElement would show the update
                        alert('updated');
                    },
                    function(reason) {
                        alert('update failed');
                    }
                );
            },
            function(reason) {
                alert('get element failed: ' + reason.message);
            }
        );
        </pre>
</div><h5 id="methods_getelementforedit_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-getelementforedit-page"><p>see description of getElement.</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-getelementforedit-page"><p>priority</p>
</div> <p><em>(default: 1)</em></p></td></tr><tr><td>update</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-getelementforedit-page"><p>update from server</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_getelementforedit_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-getelementforedit-page"><p>The promise will be resolved with the element object,
multiple calls to this method with the same id would result in 
references to the same object. This object can be edited without
affecting the same element object that&#39;s used for displays</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getelementversions">getElementVersions(reqOb, weight, update)</h3>
<div class="getelementversions"><div class="mms-elementservice-getelementversions-page"><p>Queries for an element&#39;s entire version history</p>
</div><h5 id="methods_getelementversions_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-getelementversions-page"><p>see getElement</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-getelementversions-page"><p>priority</p>
</div> <p><em>(default: 1)</em></p></td></tr><tr><td>update</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-getelementversions-page"><p>update from server</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_getelementversions_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-getelementversions-page"><p>The promise will be resolved with an array of commit objects.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getelements">getElements(reqOb, weight, update)</h3>
<div class="getelements"><div class="mms-elementservice-getelements-page"><p>Same as getElement, but for multiple ids.</p>
</div><h5 id="methods_getelements_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-getelements-page"><p>keys - {projectId, refId, elementIds (array of ids), commitId, extended}</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-getelements-page"><p>priority of request (2 is immediate, 1 is normal, 0 is low)</p>
</div> <p><em>(default: 1)</em></p></td></tr><tr><td>update</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-getelements-page"><p>(optional) whether to always get the latest
from server, even if it&#39;s already in cache (this will update the cache if exists)</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_getelements_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-getelements-page"><p>The promise will be resolved with an array of element objects,
multiple calls to this method with the same parameters would give the
same objects</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getgenericelements">getGenericElements(url, reqOb, jsonKey, weight, update)</h3>
<div class="getgenericelements"><div class="mms-elementservice-getgenericelements-page"><p>This is a method to call a predefined url that returns elements json.
A key provides the key of the json that has the elements array. </p>
</div><h5 id="methods_getgenericelements_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>url</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="mms-elementservice-getgenericelements-page"><p>the url to get</p>
</div></td></tr><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-getgenericelements-page"><p>see description of getElement.</p>
</div></td></tr><tr><td>jsonKey</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="mms-elementservice-getgenericelements-page"><p>json key that has the element array value</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-getgenericelements-page"><p>priority</p>
</div> <p><em>(default: 1)</em></p></td></tr><tr><td>update</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-getgenericelements-page"><p>update from server</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_getownedelements">getOwnedElements(reqOb, weight, update)</h3>
<div class="getownedelements"><div class="mms-elementservice-getownedelements-page"><p>Gets element&#39;s owned element objects. TBD (stub)</p>
</div><h5 id="methods_getownedelements_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-getownedelements-page"><p>see description of getElement, add &#39;depth&#39; key.</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-getownedelements-page"><p>priority</p>
</div> <p><em>(default: 1)</em></p></td></tr><tr><td>update</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-getownedelements-page"><p>update from server</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_getownedelements_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-getownedelements-page"><p>The promise will be resolved with an array of
element objects </p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_iscacheoutdated">isCacheOutdated(reqOb)</h3>
<div class="iscacheoutdated"><div class="mms-elementservice-iscacheoutdated-page"><p>Checks if the current cached element has been updated on the server, does not update the cache. 
If the element doesn&#39;t exist in the cache, it&#39;s considered not outdated</p>
</div><h5 id="methods_iscacheoutdated_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-iscacheoutdated-page"><p>see description of getElement</p>
</div></td></tr></tbody></table><h5 id="methods_iscacheoutdated_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-iscacheoutdated-page"><p>Resolved with {status: false} if cache is up to date,
Resolved with {status: true, server: server element, cache: cache element} if cache is outdated</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_search">search(reqOb, query, weight)</h3>
<div class="search"><div class="mms-elementservice-search-page"><p>Search for elements based on some query</p>
</div><h5 id="methods_search_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>reqOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-search-page"><p>see description of getElement</p>
</div></td></tr><tr><td>query</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-search-page"><p>JSON object with Elastic query format</p>
</div></td></tr><tr><td>weight</td><td><a href="" class="label type-hint type-hint-integer">integer</a></td><td><div class="mms-elementservice-search-page"><p>priority</p>
</div> <p><em>(default: 1)</em></p></td></tr></tbody></table><h5 id="methods_search_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-search-page"><p>The promise will be resolved with an array of element objects.
The element results returned will be a clone of the original server response and not cache references</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_updateelement">updateElement(elementOb)</h3>
<div class="updateelement"><div class="mms-elementservice-updateelement-page"><p>Save element to mms and update the cache if successful, the element object
must have an id, and whatever property that needs to be updated.</p>
<p><a href="#/api/mms.ElementService#methods_getelementforedit">see also getElementForEdit</a></p>
</div><h5 id="methods_updateelement_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>elementOb</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="mms-elementservice-updateelement-page"><p>An object that contains _projectId, _refId, sysmlId and any property changes to be saved.</p>
</div></td></tr></tbody></table><h5 id="methods_updateelement_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-updateelement-page"><p>The promise will be resolved with the updated cache element reference if
update is successful. If a conflict occurs, the promise will be rejected with status of 409</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_updateelements">updateElements(elementObs,, returnChildViews,)</h3>
<div class="updateelements"><div class="mms-elementservice-updateelements-page"><p>Save elements to alfresco and update the cache if successful.</p>
</div><h5 id="methods_updateelements_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>elementObs,</td><td><a href="" class="label type-hint type-hint-array">Array.&lt;Object&gt;</a></td><td><div class="mms-elementservice-updateelements-page"><p>array of element objects that contains element id and any property changes to be saved.</p>
</div></td></tr><tr><td>returnChildViews,</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="mms-elementservice-updateelements-page"><p>whether to include childViews</p>
</div></td></tr></tbody></table><h5 id="methods_updateelements_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="mms-elementservice-updateelements-page"><p>The promise will be resolved with an array of updated element references if
update is successful and will be rejected with an object with the following format:
{failedRequests: list of rejection reasons, successfulRequests: array of updated elements }</p>
</div></td></tr></table></div>
</li>
</ul>
</div>
</div>
